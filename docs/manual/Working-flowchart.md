## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã¨å‡¦ç†ãƒ•ãƒ­ãƒ¼

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€AIã‚³ãƒŸãƒƒãƒˆï¼†æ—¥èªŒç”Ÿæˆãƒ„ãƒ¼ãƒ«ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ã¨ã€ãã‚Œã‚‰ãŒã©ã®ã‚ˆã†ã«é€£æºã—ã¦å‹•ä½œã™ã‚‹ã‹ã‚’è§£èª¬ã—ã¾ã™ã€‚

### â–  ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ•ã‚©ãƒ«ãƒ€ã®å½¹å‰²

| ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ•ã‚©ãƒ«ãƒ€ | å½¹å‰² |
| :--- | :--- |
| **`scripts/commit-ai.ps1`** | **ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚** ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®Ÿè¡Œã™ã‚‹ä¸­å¿ƒçš„ãªãƒ•ã‚¡ã‚¤ãƒ«ã€‚Gitæƒ…å ±ã®åé›†ã€AIå¿œç­”ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¢ºèªã€APIå‘¼ã³å‡ºã—ã®æŒ‡ç¤ºã€æœ€çµ‚çš„ãªã‚³ãƒŸãƒƒãƒˆã¾ã§ã€å…¨ä½“ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚ |
| **`scripts/manage-prompt.ps1`** | **è¨­å®šç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚** å¯¾è©±å½¢å¼ã§`prompt-config.json`ã®å†…å®¹ã‚’å®‰å…¨ã«ç·¨é›†ã—ã¾ã™ã€‚ãŠæ°—ã«å…¥ã‚Šã®è¨­å®šã‚’ã€Œãƒ—ãƒªã‚»ãƒƒãƒˆã€ã¨ã—ã¦ä¿å­˜ãƒ»èª­è¾¼ã™ã‚‹æ©Ÿèƒ½ã‚‚æŒã¡ã¾ã™ã€‚ |
| **`scripts/api_adapters/`** | **APIé€£æºã‚¹ã‚¯ãƒªãƒ—ãƒˆç¾¤ã€‚** `invoke-gemini-api.ps1`ãªã©ãŒã“ã“ã«é…ç½®ã•ã‚Œã¾ã™ã€‚ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰æ¸¡ã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã€å„AIã‚µãƒ¼ãƒ“ã‚¹ï¼ˆGeminiãªã©ï¼‰ãŒè¦æ±‚ã™ã‚‹å½¢å¼ã«æ•´å½¢ã—ã€å®Ÿéš›ã«APIé€šä¿¡ã‚’è¡Œã†è²¬å‹™ã‚’æ‹…ã„ã¾ã™ã€‚ |
| `scripts/prompt-config.json` | **ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€‚** AIã®ãƒšãƒ«ã‚½ãƒŠã‚„ã‚¿ã‚¹ã‚¯æŒ‡ç¤ºãªã©ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹è¨­å®šãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯`.gitignore`ã§ç®¡ç†å¯¾è±¡å¤–ã¨ã™ã¹ãã§ã™ã€‚ |
| `scripts/prompt-config.default.json` | **åˆæœŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€‚** `prompt-config.json`ãŒå­˜åœ¨ã—ãªã„å ´åˆã«ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸã‚Šã€è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ãŸã‚Šã™ã‚‹éš›ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ãªã‚Šã¾ã™ã€‚ |
| **`scripts/presets/`** | **ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜ãƒ•ã‚©ãƒ«ãƒ€ã€‚** `manage-prompt.ps1`ã§ä¿å­˜ã—ãŸã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç‹¬è‡ªã®è¨­å®šãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆ`.json`å½¢å¼ï¼‰ãŒæ ¼ç´ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚‚`.gitignore`ã§ç®¡ç†å¯¾è±¡å¤–ã¨ã™ã‚‹ã®ãŒé©åˆ‡ã§ã™ã€‚ |
| `scripts/.last_goal.txt` | **å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã€‚** `commit-ai.ps1`ã§å‰å›å…¥åŠ›ã•ã‚ŒãŸã€Œä¸»ãªç›®æ¨™ã€ã‚’ä¸€æ™‚çš„ã«ä¿å­˜ã—ã¾ã™ã€‚ |
| `scripts/.ai_cache.json` | **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ«ã€‚** ä¸€åº¦APIã‹ã‚‰å–å¾—ã—ãŸAIã®å¿œç­”ã‚’ä¿å­˜ã—ã¾ã™ã€‚ã€ŒåŒã˜å·®åˆ†ã€ã¨ã€ŒåŒã˜ç›®æ¨™ã€ã®çµ„ã¿åˆã‚ã›ã®å ´åˆã¯ã€APIã‚’å‘¼ã³å‡ºã•ãšã€ã“ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å†åˆ©ç”¨ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³æ¶ˆè²»ã‚’ç¯€ç´„ã—ã¾ã™ã€‚ |
| **`docs/devlog/`** | **é–‹ç™ºæ—¥èªŒå‡ºåŠ›å…ˆã€‚** AIãŒç”Ÿæˆã—ãŸæ—¥èªŒãŒMarkdownãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æˆæœç‰©ã§ã‚ã‚Šã€ãƒ„ãƒ¼ãƒ«è‡ªä½“ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ã¯åˆ†ã‘ã‚‹ãŸã‚ã€`.gitignore`ã§ç®¡ç†å¯¾è±¡å¤–ã¨ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚ |

### â–  å…¨ä½“å‡¦ç†ãƒ•ãƒ­ãƒ¼å›³

```mermaid
graph TD
    subgraph "Phase 1: ãƒ¦ãƒ¼ã‚¶ãƒ¼å®Ÿè¡Œ & ãƒ¢ãƒ¼ãƒ‰åˆ¤å®š"
        A(ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ commit-ai.ps1 ã‚’å®Ÿè¡Œ) --> B{å®Ÿè¡Œæ™‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ï¼Ÿ};
        B -- "-Debug" --> C[ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰];
        B -- "-DryRun" --> D[ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ¢ãƒ¼ãƒ‰];
        B -- "ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã—" --> E[é€šå¸¸ãƒ¢ãƒ¼ãƒ‰];
        C --> F[ã‚µãƒ³ãƒ—ãƒ«å·®åˆ†ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨];
        D --> G[æ—¥èªŒã¯ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ã¸<br>ã‚³ãƒŸãƒƒãƒˆã¯--dry-run];
        E --> H[Gitã‹ã‚‰å®Ÿéš›ã®å·®åˆ†ã‚’å–å¾—];
    end

    subgraph "Phase 2: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåé›†ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¢ºèª"
        F --> I{ç›®æ¨™å…¥åŠ› & ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ç”Ÿæˆ};
        H --> I;
        I --> J["scripts/.last_goal.txt<br>(ç›®æ¨™å±¥æ­´)"];
        I --> K{ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯å­˜åœ¨ã™ã‚‹ã‹ï¼Ÿ};
        K -- "Yes" --> L["scripts/.ai_cache.json<br>ã‹ã‚‰å¿œç­”ã‚’èª­ã¿è¾¼ã‚€"];
        K -- "No" --> M[APIå‘¼ã³å‡ºã—æº–å‚™];
    end

    subgraph "Phase 3: APIé€£æº (ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãªã„å ´åˆ)"
        M --> N["scripts/prompt-config.json<br>ã‹ã‚‰AIè¨­å®šã‚’èª­ã¿è¾¼ã‚€"];
        M --> O[ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆJSONã‚’æ§‹ç¯‰];
        O --> P[invoke-gemini-api.ps1 ã‚’å‘¼ã³å‡ºã™];
        P -- "ãƒªãƒˆãƒ©ã‚¤å‡¦ç†(50xç³»)" --> Q((ğŸ¤– Gemini API));
        Q --> P;
        P --> R[å¿œç­”ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜<br>scripts/.ai_cache.json];
        R --> S[AIå¿œç­”ã‚’å–å¾—];
    end

    subgraph "Phase 4: å¿œç­”ã®è¡¨ç¤ºã¨æœ€çµ‚å‡¦ç†"
        L --> T{AIå¿œç­”ã‚’ãƒ‘ãƒ¼ã‚¹};
        S --> T;
        T --> U[ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨æ—¥èªŒå†…å®¹ã‚’è¡¨ç¤º];
        U --> V{"ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèª<br>(ã‚³ãƒŸãƒƒãƒˆ/ç·¨é›†/ä¸­æ­¢)"};
        V -- "ã‚³ãƒŸãƒƒãƒˆå®Ÿè¡Œ" --> W{ãƒ¢ãƒ¼ãƒ‰ã«å¿œã˜ãŸå‡¦ç†};
        W -- "DryRunãƒ¢ãƒ¼ãƒ‰" --> X[--dry-runã§ã‚³ãƒŸãƒƒãƒˆå®Ÿè¡Œ<br>ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤];
        W -- "é€šå¸¸ãƒ¢ãƒ¼ãƒ‰" --> Y[é€šå¸¸ã®ã‚³ãƒŸãƒƒãƒˆã¨ãƒ—ãƒƒã‚·ãƒ¥];
        W -- "Debugãƒ¢ãƒ¼ãƒ‰(å˜ä½“)" --> Z([å®‰å…¨ã«çµ‚äº†]);
    end

    classDef userAction fill:#fff2cc,stroke:#333,stroke-width:2px,color:#333;
    classDef scriptAction fill:#e6f0ff,stroke:#333,stroke-width:1px,color:#333;
    classDef fileIO fill:#e6ffe6,stroke:#333,stroke-width:1px,color:#333;
    classDef decision fill:#ffebf0,stroke:#333,stroke-width:1px,color:#333;
    classDef api fill:#f0e6ff,stroke:#333,stroke-width:2px,color:#333;

    class A,V userAction;
    class B,K,W,T decision;
    class C,D,E,F,G,H,I,M,O,P,S,U,X,Y,Z scriptAction;
    class J,L,N,R fileIO;
    class Q api;
```

---
### â–  å…¨ä½“å‡¦ç†ãƒ•ãƒ­ãƒ¼å›³

```mermaid
graph LR
    subgraph "ç”Ÿæˆç‰©"
        direction TB
        O1["O1: docs/devlog/*.md<br>(é–‹ç™ºæ—¥èªŒ)"];
    end

    subgraph "è¨­å®šãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«"
        direction TB
        F1["F1: prompt-config.json<br>(ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š)"];
        F2["F2: prompt-config.default.json<br>(åˆæœŸè¨­å®š)"];
        F3["F3: presets/*.json<br>(è¨­å®šãƒ—ãƒªã‚»ãƒƒãƒˆç¾¤)"];
        F4["F4: ai_cache.json<br>(AIå¿œç­”ã‚­ãƒ£ãƒƒã‚·ãƒ¥)"];
        F5["F5: last_goal.txt<br>(ç›®æ¨™å…¥åŠ›å±¥æ­´)"];
    end
    
    subgraph "å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ"
        direction TB
        S1["S1: commit-ai.ps1<br>(ãƒ¡ã‚¤ãƒ³å‡¦ç†)"];
        S2["S2: manage-prompt.ps1<br>(è¨­å®šç®¡ç†)"];
        S3["S3: invoke-gemini-api.ps1<br>(API Adapter)"];
    end

    subgraph "å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹"
        direction TB
        E1(("E1: ğŸ¤– Gemini API"));
    end

    F1 ~~~ O1;
    S3 ~~~ F1

%% linkStyle 2 stroke:#0000FF,stroke-width:2px 
%% linkStyle 3 stroke:#000FF,stroke-width:2px
%% linkStyle 4 stroke:#F000FF,stroke-width:2px

    S1 --> F1; 
    S1<--> F4;
    S1<--> F5;
    S1 -- "å®Ÿè¡Œ" --> S3;
    S1 --> O1;


    S2 <--> F3; 
    S2 <--> F1; 
    S2 --> F2; 

%%    S2 -- "(èª­è¾¼/æ›¸è¾¼)" --> F1; 


    S3 -- "ãƒ‡ãƒ¼ã‚¿" --> E1;

    classDef userAction fill:#fff2cc,stroke:#333,stroke-width:2px,color:#333;
    classDef scriptAction fill:#e6f0ff,stroke:#333,stroke-width:1px,color:#333;
    classDef fileIO fill:#e6ffe6,stroke:#333,stroke-width:1px,color:#333;
    classDef decision fill:#ffebf0,stroke:#333,stroke-width:1px,color:#333;
    classDef api fill:#f0e6ff,stroke:#333,stroke-width:2px,color:#333;

    class A,V userAction;
    class B,K,W,T decision;
    class C,D,E,F,G,H,I,M,O,P,S,U,X,Y,Z scriptAction;
    class J,L,N,R fileIO;
    class Q api;
```
```mermaid
flowchart LR
a1[a-1] --> a2[a-2] --> a3[a-3] --> a4[a-4]
b1(b-1) --> b2(b-2) --> b3(b-3) --> b4(b-4)

a1 --> b2
```